import{_ as L,r,u as P,k as F,l as q,c as n,a as e,t as m,m as b,f as h,n as E,q as U,s as p,F as $,b as I,g as V,j as _,o as a,x as S,p as H,i as J,y as O}from"./index-OxTU7XsW.js";const G="/2024Vue_camping_final/plus.svg",K="/2024Vue_camping_final/noTodo.png",g=k=>(H("data-v-f6e1f610"),k=k(),J(),k),Q={class:"vw-100 vh-100"},W={class:"d-flex justify-content-between px-6 py-3"},X=g(()=>e("div",{class:"logo-size"},[e("img",{src:O,class:"img-fluid",alt:"todolistLogo"})],-1)),Y={class:"d-flex"},Z={class:"fw-bold me-3"},ee={class:"d-flex justify-content-center pt-6"},te={class:"list-width"},oe={class:"d-flex shadow todoinput-outside mb-3"},se=g(()=>e("img",{src:G,class:"btn-image",alt:"plus"},null,-1)),ne=[se],ae=g(()=>e("div",{class:"d-flex justify-content-center mt-5"},[e("span",{class:"loader"})],-1)),ce=[ae],le={key:0,class:"d-flex flex-column align-items-center mt-5"},de=g(()=>e("p",{class:"mb-4 text-dark"},"目前尚無待辦事項",-1)),ie=g(()=>e("div",{class:"no-todo-img"},[e("img",{src:K,alt:"No-todo",class:"img-fluid"})],-1)),ue=[de,ie],re={key:1,class:"bg-white w-100 rounded shadow"},he={class:"d-flex"},pe={class:"pt-3 ps-4 pb-4 pe-3"},_e={key:0},ve={class:"d-flex align-items-center mb-2"},fe={class:"d-flex align-items-center pb-2 w-100 border-bottom me-2"},me=["onUpdate:modelValue","onChange"],ge=["onClick"],ke={key:1},be={class:"d-flex align-items-center mb-2"},xe={class:"d-flex align-items-center pb-2 w-100 border-bottom me-2"},ye=["onUpdate:modelValue","onChange"],Ce=["onClick"],Te={key:2},we={class:"d-flex align-items-center mb-2"},$e={class:"d-flex align-items-center pb-2 w-100 border-bottom me-2"},Ie=["onUpdate:modelValue","onChange"],Ve=["onClick"],Se={class:"mt-3"},Ne={class:"mb-0 fs-14 text-dark"},v="https://todolist-api.hexschool.io/",Ue={__name:"TodoView",setup(k){const A=document.cookie.replace(/(?:(?:^|.*;\s*)hexSchoolSignIntoken\s*\=\s*([^;]*).*$)|^.*$/,"$1"),u=r({headers:{Authorization:A}}),x=P(),c=r([]),f=r({}),y=r(!0),C=F(()=>{const s=c.value.filter(o=>(o==null?void 0:o.status)===!1).length,d=c.value.filter(o=>(o==null?void 0:o.status)===!1),t=c.value.filter(o=>(o==null?void 0:o.status)===!0);return{noCheckNum:s,noCheck:d,completedCheck:t}}),l=r("allTodo"),N=r("");async function M(){try{const s=await _.get(`${v}users/checkout`,u.value);N.value=s.data.nickname}catch(s){s.response.data.status===!1&&setTimeout(()=>{alert("驗證失敗，請重新登入"),x.push("/")},1e3)}}async function i(){try{const s=await _.get(`${v}todos/`,u.value);c.value=s.data.data,y.value=!1;return}catch(s){s.response.data.status===!1&&setTimeout(()=>{alert("驗證失敗，請重新登入"),x.push("/")},1e3)}}async function D(){if(f.value.content){try{const s=await _.post(`${v}todos/`,f.value,u.value);i(),f.value.content="",l.value="allTodo"}catch{alert("新增資料錯誤，請再試一次"),i()}return}else return}async function T(s){const d=c.value.findIndex(o=>o.id===s.id),t=c.value[d].id;try{const o=await _.patch(`${v}todos/${t}/toggle`,t,u.value);i()}catch(o){console.log(o),alert("資料更新錯誤，請再試一次"),i()}}async function w(s){const d=c.value.findIndex(o=>o.id===s.id),t=c.value[d].id;try{const o=await _.delete(`${v}todos/${t}`,u.value);i()}catch{alert("刪除資料錯誤，請再試一次"),i()}}function j(){l.value="allTodo"}function R(){l.value="noTodo"}function z(){l.value="completedTodo"}async function B(){try{const s=await _.post(`${v}users/sign_out`,"",u.value);document.cookie="hexSchoolSignIntoken=; expires=Thu, 01 Jan 1970 00:00:00 UTC;",alert("登出成功"),x.push("/")}catch{alert("登出失敗，請再嘗試一次")}}return q(()=>{i(),M()}),(s,d)=>(a(),n("div",Q,[e("nav",W,[X,e("div",Y,[e("p",Z,m(N.value)+"的代辦",1),e("a",{href:"#",class:"text-decoration-none link-dark",onClick:b(B,["prevent"])},"登出 ")])]),e("div",ee,[e("div",te,[e("div",oe,[h(e("input",{type:"text",class:"border-0 outline-none todo-input w-100","onUpdate:modelValue":d[0]||(d[0]=t=>f.value.content=t),placeholder:"新增待辦事項"},null,512),[[E,f.value.content,void 0,{trim:!0}]]),e("button",{type:"button",class:"btn btn-dark p-1",onClick:D},ne)]),h(e("div",null,ce,512),[[U,y.value]]),h(e("div",null,[c.value.length===0?(a(),n("div",le,ue)):(a(),n("div",re,[e("div",he,[e("a",{href:"#",class:p(["fw-bold page-a",{"page-active":l.value==="allTodo"}]),onClick:b(j,["prevent"])},"全部",2),e("a",{href:"#",class:p(["fw-bold page-a",{"page-active":l.value==="noTodo"}]),onClick:b(R,["prevent"])},"待完成",2),e("a",{href:"#",class:p(["fw-bold page-a",{"page-active":l.value==="completedTodo"}]),onClick:b(z,["prevent"])},"已完成",2)]),e("div",pe,[l.value==="allTodo"?(a(),n("div",_e,[(a(!0),n($,null,I(c.value,t=>(a(),n("div",{key:t.id},[e("div",ve,[e("div",fe,[h(e("input",{type:"checkbox",class:"todo-check me-3","onUpdate:modelValue":o=>t.status=o,onChange:o=>T(t)},null,40,me),[[S,t.status]]),e("p",{class:p(["mb-0 text-dark fs-14",{"check-success":t.status}])},m(t.content),3)]),e("button",{type:"button",class:"btn close-btn",onClick:o=>w(t)},null,8,ge)])]))),128))])):V("",!0),l.value==="noTodo"?(a(),n("div",ke,[(a(!0),n($,null,I(C.value.noCheck,t=>(a(),n("div",{key:t.id},[e("div",be,[e("div",xe,[h(e("input",{type:"checkbox",class:"todo-check me-3","onUpdate:modelValue":o=>t.status=o,onChange:o=>T(t)},null,40,ye),[[S,t.status]]),e("p",{class:p(["mb-0 text-dark fs-14",{"check-success":t.status}])},m(t.content),3)]),e("button",{type:"button",class:"btn close-btn",onClick:o=>w(t)},null,8,Ce)])]))),128))])):V("",!0),l.value==="completedTodo"?(a(),n("div",Te,[(a(!0),n($,null,I(C.value.completedCheck,t=>(a(),n("div",{key:t.id},[e("div",we,[e("div",$e,[h(e("input",{type:"checkbox",class:"todo-check me-3","onUpdate:modelValue":o=>t.status=o,onChange:o=>T(t)},null,40,Ie),[[S,t.status]]),e("p",{class:p(["mb-0 text-dark fs-14",{"check-success":t.status}])},m(t.content),3)]),e("button",{type:"button",class:"btn close-btn",onClick:o=>w(t)},null,8,Ve)])]))),128))])):V("",!0),e("div",Se,[e("p",Ne,m(C.value.noCheckNum)+" 個待完成項目",1)])])]))],512),[[U,!y.value]])])])]))}},Me=L(Ue,[["__scopeId","data-v-f6e1f610"]]);export{Me as default};
